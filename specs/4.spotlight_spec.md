---
tags: []
---
# **スポットライト（/phase/spotlight）— 完全版（公開→ゲート→手札／JOKERボーナスは本フェーズ内で処理）**

  

## **役割**

- **公開領域**で「黒子公開 → 判定 → 行動権決定 → セットを1枚オープン（任意）」まで実施。
    
- **非公開領域**は、**オープン結果が非JOKER**のときに限り、**同ランク手札の選択→ペア配置**のみ行う。
    
- **JOKERをオープンした場合のボーナス**は、**このスポットライト内で追加1枚オープン＋自動ペア**まで完了させ、**そのままカーテンコールへ**遷移。

- **非JOKERで手札が揃わずペア不成立**だった場合は、本フェーズ終了後に**/phase/backstage/gate** へ移り、バックステージアクションを実行する。
    

---

## **可視範囲の原則**

- **公開（相手にも見える）**：黒子公開、判定結果、誰が行動するか、セットのオープン（結果まで）、JOKERボーナスの追加オープンと自動ペア。
    
- **非公開（ゲート後）**：手札表示、同ランクの選択、非JOKER時のペア成立操作。
    

---

## **入口**

- 本フェーズは**公開開始**のため、入場時ゲートなし。
    
- ヘッダー：スポットライト（右上：**［ボードチェック］**／［ヘルプ］（モーダル／`help/spotlight.md` を表示））。**手札ボタンは表示しない**。**スマホ幅ではボードチェックとヘルプをハンバーガーメニューにまとめて表示する。**
    

---

## **フロー（段階）**

  

### **1) 黒子公開（公開）**

- ボタン：**［黒子を公開する］**（一度きり）→ 確認 → 反転。
    
- 自動判定：役者ランク ≟ 黒子ランク → 一致 / 不一致。
    
- **判定ポップアップ（公開）**
    
    - 一致！ — {提示者} がセットをオープンできます
        
    - 不一致！ — {ブーイング側} がセットをオープンできます
        
    - ボタン：**［セットをオープンする］**／［今回はスキップ］
        
    

  

### **2) ブーイング対象ペアの帰属（公開・自動）**

- 対象：そのラウンドの**役者＋黒子**。
    
- 帰属ルール：
    
    - 一致 → **提示者ステージに残留**
        
    - 不一致 → **ブーイング側ステージに移動**
        
    
- UI：結果パネルに「ペアの帰属：◯◯ステージ」を明記（移動アニメあり）。
    

  

### **3) セットから1枚オープン（公開・任意）**

- 操作権：一致→提示者／不一致→ブーイング側。
    
- **［セットをオープンする］** → 一覧から1枚選択 → **表向き**（確認あり）。
    
- **オープン結果ポップアップ（公開）**：{CARD_LABEL} をオープンしました。
    

  

#### **3-1) オープンが** 

#### **JOKER**

####  **の場合（公開で**

#### **即ボーナス**

#### **）**

- ガイダンス（公開）：JOKER！ 追加でもう1枚オープンして、自動でペアを作ります。
    
- **追加オープン**：セットからさらに**1枚**選んで表向き（確認あり）。
    
- **自動ペア（公開で宣言／盤面反映）**：
    
    - **カミ**＝追加でオープンしたカード（表）
        
    - **シモ**＝JOKER（裏）
        
    - **配置先**＝**オープンした当人のステージ**（残留）
        
    
- **遷移**：JOKERボーナス処理完了後は**即カーテンコールへ**（/phase/curtaincall/gate）。
    
    - 例外：セット残が**0**で追加オープン不能 → 自動ペア不可の旨を公開表示し、そのまま**カーテンコールへ**。
        
    - セット残が**1**なら、その1枚を自動選択して表向き→自動ペア→**カーテンコール**。
        
    

  

#### **3-2) オープンが** 

#### **非JOKER**

####  **の場合（公開→非公開）**

- **公開**はここまで。以降は**非公開**で手札選択を行う可能性がある。
    
- なお、**オープン後のセット残=1**なら、この後の処理完了後に**カーテンコール**へ。
    

  

### **4) ハンドオフゲート（非公開開始の合図）**

- 全画面：{行動プレイヤー} の手札を表示します。相手に見えない状態で［OK］
    
- **［OK］**で手札を初描画（非公開モードに遷移）。
    

  

### **5) 手札選択→ペア成立（非JOKER時のみ・非公開・必須）**

- 条件：**直前にオープンしたカードが非JOKER** かつ **手札に同ランクがある**。

- 操作：手札から**同ランク1枚**を**必ず**選択 → **ペア配置**。候補が複数ある場合はその中から1枚を選択し、候補が1枚のみの場合は自動選択で構わない。

    - **カミ**＝（公開で）オープンしたカード（表）

    - **シモ**＝（非公開で）選ばれた手札（裏）

    - **配置先**＝**行動プレイヤーのステージ**（残留）

- スキップは不可。同ランクが存在しない場合のみ、ペア未成立として後続処理に進む。
        
    

  

### **6) フェーズ終了→遷移**

- **JOKERボーナス実行済み** → **/phase/curtaincall/gate**。

- **非JOKER**：

    - **オープン後のセット残=1** → **/phase/curtaincall/gate**

    - **同ランク手札ありでペア成立** → **/phase/intermission/gate**

    - **手札不足でペア未成立** → **/phase/backstage/gate**（公開担当ではないプレイヤーがバックステージ・アクションを実施）。完了後
      は自動で **/phase/intermission/gate** へ遷移。
        
    

---

## **ボードチェック（共通・モーダル）**

- タブ：**セット残数**／**プレイヤーAステージ**／**プレイヤーBステージ**／**スコア**（公開情報のみ、いつでも参照可）
    

---

## **例外・ガード**

- 黒子公開は**一度きり・取り消し不可**。
    
- セットオープンは**最大1枚**（JOKER時の**追加1枚**はボーナスとして別枠）。
    
- **手札表示は必ずゲート後**。
    
- モーダル中は背景操作不可／連打ロック（200–400ms）。
    
- 戻る操作時は秘匿再描画ガード（手札・裏情報を消去）。
    

---

## **状態（例）**

```
{
  "phase": "spotlight",
  "presenter": "lumina",
  "booer": "nox",
  "stagePair": { "actor": "S A", "kuroko": "H 9" },
  "judge": "mismatch",                       // "match" | "mismatch"
  "reading": { "watchCall": "boo", "correct": true },
  "scoreDelta": { "lumina": 0, "nox": 1 },

  "pairMovement": { "to": "booerStage" },    // match→presenter / mismatch→booer

  "openControl": "nox",                      // match→presenter / mismatch→booer
  "openedFromSet": { "rank": "A", "suit": "D", "joker": false } | { "joker": true },
  "bonus": {
    "isJoker": false,                        // true ならボーナス実行
    "extraOpened": null,                     // {rank,suit}（JOKER時の追加オープン）
    "autoPair": null                         // {kami:"AD", shimo:"JOKER", to:"noxStage"}
  },

  "canSecretPair": true,                     // 非JOKERかつ同ランク手札あり
  "secretPair": { "used": false, "handCard": null },

  "setRemaining": 6,
  "nextRoute": "/phase/intermission"         // JOKER or setRemaining==1 なら "/phase/curtaincall"
}
```

---

## **受け入れ基準**

- 入場時は**手札非表示**。
    
- 黒子公開→**一致/不一致**を**公開ポップアップ**で提示し、**誰がセットをオープンできるか**を明示。
    
- **ブーイング対象ペア**は、一致→提示者残留／不一致→ブーイング側へ移動がUI/状態に反映。
    
- **セットオープンがJOKER**のとき、**スポットライト内で**追加1枚オープン→**カミ＝追加オープン（表）／シモ＝JOKER（裏）を当人ステージに自動配置**→**即カーテンコール**。
    
- **セットオープンが非JOKER**のとき、**ハンドオフゲート後に手札表示**して同ランク1枚を選べば**自分ステージにペア配置**（任意）。
    
- **オープン後のセット残=1**は（JOKERでなくても）処理完了後に**カーテンコール**へ、その他は**インターミッション**へ。
    

---

## **ポップアップ文言例**

- 判定（公開）：
    
    - **一致！ — {提示者} がセットをオープンします**
        
    - **不一致！ — {ブーイング側} がセットをオープンします**
        
    
- オープン結果（公開）：
    
    - **{CARD_LABEL} をオープンしました。**
        
    - **JOKER！ 追加で1枚オープンし、自動でペアを作ります。**
        
    
- ゲート（非公開開始）：
    
    - **{行動プレイヤー} の手札を表示します。端末を持ち替えて、OK。**
        
    
- 非公開ペア成立：
    
    - **ペア成立：カミ＝{OPEN_CARD}／シモ＝{HAND_CARD}（{行動プレイヤー}ステージ）**
